{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["class Observer {\n  constructor(data) {\n    // Object.defineProperty 只能劫持已经存在的属性，后增的或者删除的不知道\n    // vue2 里面会为此单独写一些 api $set $delete\n    if (Array.isArray(data)) {\n      // 这里我们可以重写数组中的7个变异方法，是可以修改数组本身的\n    } else {\n      this.walk(data)\n    }\n  }\n\n  walk(data) {\n    // 循环对象，对属性依次进行劫持\n\n    // “重新定义”属性\n    Object.keys(data).forEach((key) => {\n      defineReactive(data, key, data[key])\n    })\n  }\n}\n\n// 这里有闭包\nexport function defineReactive(target, key, value) {\n  // 属性劫持\n  // 如果是对象，再次进行深度遍历响应\n  observe(value)\n  Object.defineProperty(target, key, {\n    get() {\n      // 取值的时候，会执行 get\n      return value\n    },\n    set(newValue) {\n      // 修改的时候，会执行 set\n      if (newValue === value) {\n        return\n      }\n      value = newValue\n      observe(value)\n    },\n  })\n}\n\nexport function observe(data) {\n  if (typeof data !== 'object' || !data) {\n    return // 只对对象进行劫持\n  }\n  // 如果一个对象已经被劫持过了，那就不需要再劫持了\n  // 要判断一个对象是否被劫持过，可以添加一个实例，用实例来判断是否被劫持成功\n\n  return new Observer(data)\n}\n","import { observe } from './observe/index'\n\nexport function initState(vm) {\n  const opts = vm.$options // 获取所有的选项\n  if (opts.data) {\n    initData(vm)\n  }\n}\n\nfunction initData(vm) {\n  let data = vm.$options.data\n  data = typeof data === 'function' ? data.call(this) : data\n\n  // 对数据进行劫持\n  // vue2 中采用了一个 api defineProperty\n  vm._data = data\n  observe(data)\n\n  // 将 vm._data 用 vm 来代理了\n\n  for (let key in data) {\n    proxy(vm, '_data', key)\n  }\n}\n\nfunction proxy(vm, target, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[target][key]\n    },\n    set(newValue) {\n      vm[target][key] = newValue\n    },\n  })\n}\n","import { initState } from './state'\n\n// 就是给 Vue 添加 Init 方法\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    // 用户初始化操作\n    // vm vm.$options 就是获取用户的配置\n\n    // 我们使用的 vue 的时候 $nextTIck $data $attr 。。。\n    const vm = this\n    vm.$options = options // 将用户的选项挂载到实例上\n\n    // 初始化状态\n    initState(vm)\n  }\n}\n","import { initMixin } from './init'\n\nfunction Vue(options) {\n  // options 就是用户的选项值\n  this._init(options) // 默认就调用了 __init\n}\n\ninitMixin(Vue) // 扩展了 init 方法\n\nexport default Vue\n"],"names":["Observer","data","_classCallCheck","Array","isArray","walk","_createClass","key","value","Object","keys","forEach","defineReactive","target","observe","defineProperty","get","set","newValue","_typeof","initState","vm","opts","$options","initData","call","_data","proxy","initMixin","Vue","prototype","_init","options"],"mappings":"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"}